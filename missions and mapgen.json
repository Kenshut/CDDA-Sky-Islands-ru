[
  {
    "type": "effect_on_condition",
    "id": "EOC_safely_landed",
    "//": "Called on landing. Creates the extract mission, the slaughter mission, and two optional missions.",
    "effect": [
      {
        "run_eocs": [ "EOC_create_slaughter", "EOC_create_bonus", "EOC_create_bonus", "EOC_create_extract", "EOC_create_extract" ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Random_Loc_Warp",
    "//": "Picks a random location to warp to based on the player's unlocked difficulty.",
    "effect": [
      {
        "weighted_list_eocs": [
          [ "EOC_Location1w", { "const": 15 } ],
          [ "EOC_Location2w", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_Location3w", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Random_Loc_Extract",
    "//": "Picks a random location to place the extract based on the player's unlocked difficulty.",
    "effect": [
      {
        "weighted_list_eocs": [
          [ "EOC_Location1e", { "const": 15 } ],
          [ "EOC_Location2e", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_Location3e", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Random_Loc_Mission",
    "//": "Picks a random location to place the missions based on the player's unlocked difficulty.",
    "effect": [
      {
        "weighted_list_eocs": [
          [ "EOC_Location1m", { "const": 15 } ],
          [ "EOC_Location2m", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_Location3m", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_create_extract",
    "//": "Actually creates the extract by first choosing a location, then assigning a mission there. It will also clean up that spot later so the exit room doesn't remain for future expeditions.",
    "effect": [
      { "run_eocs": [ "EOC_Random_Loc_Extract" ] },
      { "assign_mission": "MISSION_REACH_EXTRACT" },
      {
        "revert_location": { "global_val": "OM_missionspot" },
        "time_in_future": "infinite",
        "key": "return_portal_close"
      },
      { "mapgen_update": "mapgen_dummyplace", "target_var": { "global_val": "OM_missionspot" } }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_create_slaughter",
    "effect": [
      {
        "weighted_list_eocs": [
          [ "EOC_slaughtermission1", { "const": 10 } ],
          [ "EOC_slaughtermission2", { "const": 20 } ],
          [ "EOC_slaughtermission3", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_slaughtermission4", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_slaughtermission5", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_slaughtermission6", { "const": 5 } ],
          [ "EOC_slaughtermission7", { "const": 5 } ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_create_bonus",
    "//": "Actually creates a bonus mission by first choosing a location, then assigning a mission there. It will also clean up that spot later so any map changes don't remain for future expeditions.",
    "effect": [
      { "run_eocs": [ "EOC_Random_Loc_Mission" ] },
      {
        "revert_location": { "global_val": "OM_missionspot" },
        "time_in_future": "infinite",
        "key": "return_portal_close"
      },
      { "mapgen_update": "mapgen_dummyplace", "target_var": { "global_val": "OM_missionspot" } },
      {
        "weighted_list_eocs": [
          [ "EOC_bonusmission_1", { "const": 45 } ],
          [ "EOC_bonusmission_2", { "const": 15 } ],
          [ "EOC_bonusmission_3", { "const": 10 } ],
          [ "EOC_bonusmission_4", { "const": 15 } ],
          [ "EOC_bonusmission_5", { "const": 10 } ],
          [ "EOC_bonusmission_6", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_bonusmission_7", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_bonusmission_8", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_bonusmission_9", { "global_val": "var", "var_name": "hardestmissions", "default": 0 } ],
          [ "EOC_bonusmission_12", { "global_val": "var", "var_name": "hardestmissions", "default": 0 } ],
          [ "EOC_bonusmission_13", { "global_val": "var", "var_name": "hardestmissions", "default": 0 } ],
          [ "EOC_bonusmission_10", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_bonusmission_11", { "global_val": "var", "var_name": "hardestmissions", "default": 0 } ],
          [ "EOC_assassinmission1", { "global_val": "var", "var_name": "hardmissions", "default": 0 } ],
          [ "EOC_assassinmission2", { "global_val": "var", "var_name": "hardermissions", "default": 0 } ],
          [ "EOC_assassinmission3", { "global_val": "var", "var_name": "hardestmissions", "default": 0 } ]
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_1",
    "effect": [ { "assign_mission": "MISSION_BONUS_TREASURE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_2",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_LIGHT" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_3",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_HORDE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_4",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_MID" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_5",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_MID_HORDE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_6",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_HARD" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_7",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_ELITE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_8",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_BOSS" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_9",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_BOSS_GROUP" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_12",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_BOSS_HORDE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_13",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_BOSS_MULTI" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_10",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_MIGO" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_bonusmission_11",
    "effect": [ { "assign_mission": "MISSION_BONUS_KILL_MIGO_ELITE" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission1",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_ZED1" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission2",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_ZED2" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission3",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_ZED3" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission4",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_MIGO" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission5",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_NETHER" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission6",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_BIRD" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_slaughtermission7",
    "effect": [ { "assign_mission": "MISSION_BONUS_SLAUGHTER_MAMMAL" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_assassinmission1",
    "effect": [ { "assign_mission": "MISSION_BONUS_ASSASSIN1" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_assassinmission2",
    "effect": [ { "assign_mission": "MISSION_BONUS_ASSASSIN2" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_assassinmission3",
    "effect": [ { "assign_mission": "MISSION_BONUS_ASSASSIN3" } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location1w",
    "//": "Picks a random field.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "field",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 1200,
          "min_distance": 200,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location2w",
    "//": "Picks a random forest.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "forest",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 1200,
          "min_distance": 200,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location3w",
    "//": "Picks a random house.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "house",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 1200,
          "min_distance": 200,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location1e",
    "//": "Picks a random field.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "field",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 160,
          "min_distance": 40,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location2e",
    "//": "Picks a random forest.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "forest",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 160,
          "min_distance": 40,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location3e",
    "//": "Picks a random house.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "house",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 160,
          "min_distance": 40,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location1m",
    "//": "Picks a random field.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "field",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 80,
          "min_distance": 20,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      },
      { "arithmetic": [ { "global_val": "var", "var_name": "location_difficulty_bonus" }, "=", { "const": 0 } ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location2m",
    "//": "Picks a random forest.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "forest",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 80,
          "min_distance": 20,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      },
      { "arithmetic": [ { "global_val": "var", "var_name": "location_difficulty_bonus" }, "=", { "const": 1 } ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_Location3m",
    "//": "Picks a random house.",
    "effect": [
      {
        "u_location_variable": { "global_val": "OM_missionspot" },
        "target_params": {
          "om_terrain": "house",
          "om_terrain_match_type": "CONTAINS",
          "search_range": 80,
          "min_distance": 2,
          "reveal_radius": 2,
          "z": 0,
          "random": true
        }
      },
      { "arithmetic": [ { "global_val": "var", "var_name": "location_difficulty_bonus" }, "=", { "const": 2 } ] }
    ]
  },
  {
    "id": "MISSION_REACH_EXTRACT",
    "type": "mission_definition",
    "name": { "str": "Доберитесь до одной из точек выхода!" },
    "goal": "MGOAL_GO_TO",
    "description": "Если вы хотите вернуться домой со своими вещами, вам нужно будет добраться до одной из этих точек искажения пространства. Это единственное, что может вернуть вас на ваш остров-убежище в целости и сохранности.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": { "place_nested": [ { "chunks": [ "mx_exitroom" ], "x": [ 0, 13 ], "y": [ 0, 13 ] } ] }
    }
  },
  {
    "id": "MISSION_BONUS_TREASURE",
    "type": "mission_definition",
    "name": { "str": "Найди осколки искажённого пространства!" },
    "goal": "MGOAL_GO_TO",
    "description": "Очень небольшое скопление энергии искривления пространства оставило <color_light_blue>осколки</color> в этом месте. Все, что вам нужно сделать, это найти и извлечь их. Поблизости могут быть угрозы, но, в отличие от большинства заданий, на месте нет специальной охраны. Минимальное вознаграждение, но небольшой риск.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": { "place_nested": [ { "chunks": [ "mx_treasuregoal" ], "x": [ 0, 13 ], "y": [ 0, 13 ] } ] }
    },
    "end": { "effect": [ { "u_adjust_var": "missionswon", "adjustment": 1 } ] }
  },
  {
    "id": "MISSION_BONUS_KILL_LIGHT",
    "type": "mission_definition",
    "name": { "str": "Убейте зомбей, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Горстка зомби собирается в месте, где высокий резонанс пространства. Очистите их за минимальную награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked", "repeat": [ 4, 8 ] }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 3 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_HORDE",
    "type": "mission_definition",
    "name": { "str": "Убейте орду, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Орда низкоуровневых зомби собирается в месте, где высокий резонанс пространства. Очистите их за небольшую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked", "repeat": [ 8, 24 ] }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 4 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_MID",
    "type": "mission_definition",
    "name": { "str": "Убейте эволюционировавших зомби, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Рой эволюционировавших зомби собирается в месте, где высокий резонанс пространства. Очистите их за среднюю награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 4 ] },
          {
            "group": "GROUP_SI_ZOMMID",
            "x": [ 1, 22 ],
            "y": [ 1, 22 ],
            "target": true,
            "name": "Marked",
            "repeat": [ 3, 8 ]
          }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 4 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_MID_HORDE",
    "type": "mission_definition",
    "name": { "str": "Убейте эволюционировавшую орду, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Огромная орда эволюционировавших зомби собирается в месте, где высокий резонанс пространства. Очистите их за большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 6 ] },
          {
            "group": "GROUP_SI_ZOMMID",
            "x": [ 1, 22 ],
            "y": [ 1, 22 ],
            "target": true,
            "name": "Marked",
            "repeat": [ 8, 20 ]
          }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 5 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_HARD",
    "type": "mission_definition",
    "name": { "str": "Убейте ужасных зомби, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Рой довольно мощных зомби собирается в месте, где высокий резонанс пространства. Очистите их за большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 4 ] },
          { "group": "GROUP_SI_ZOMMID", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 2 ] },
          {
            "group": "GROUP_SI_ZOMHARD",
            "x": [ 1, 22 ],
            "y": [ 1, 22 ],
            "target": true,
            "name": "Marked",
            "repeat": [ 4, 8 ]
          }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 5 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_ELITE",
    "type": "mission_definition",
    "name": { "str": "Убейте элитных зомби, пожирающих искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Рой чрезвычайно опасных зомби собирается в месте, где высокий резонанс пространства. Очистите их за очень большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMMID", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 2 ] },
          { "group": "GROUP_SI_ZOMHARD", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 1 ] },
          {
            "group": "GROUP_SI_ZOMELITE",
            "x": [ 1, 22 ],
            "y": [ 1, 22 ],
            "target": true,
            "name": "Marked",
            "repeat": [ 4, 8 ]
          }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 8 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_BOSS",
    "type": "mission_definition",
    "name": { "str": "Убейте повелителя зомби, пожирающего искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Единственный чрезвычайно могущественный зомби был найден в месте, где высокий резонанс пространства. Уничтожьте его за очень большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [ { "group": "GROUP_SI_ZOMBOSS", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked" } ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 10 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_BOSS_MULTI",
    "type": "mission_definition",
    "name": { "str": "Убейте суперкоманду зомби, пожирающего искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Команда чрезвычайно могущественных зомби была обнаружена в месте, где высокий резонанс пространства. Уничтожьте его за очень большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMBOSS", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked", "pack_size": [ 2, 5 ] }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 10 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_BOSS_GROUP",
    "type": "mission_definition",
    "name": { "str": "Убейте пожирающего искажённое пространство лидера зомби!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Чрезвычайно могущественный зомби был обнаружен в месте, где высокий резонанс пространства. Имейте в виду, что его будет сопровождать элитный рой! Уничтожьте их всех за огромную награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMBOSS", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked" },
          { "group": "GROUP_SI_ZOMELITE", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 2, 5 ] }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 12 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_BOSS_HORDE",
    "type": "mission_definition",
    "name": { "str": "Убейте повелителя орды зомби, пожирающего искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Чрезвычайно могущественный зомби был обнаружен в месте, где высокий резонанс пространства. Имейте в виду, что его будет сопровождать огромная орда более слабых зомби! Уничтожьте их всех за огромную награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_ZOMBOSS", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked" },
          { "group": "GROUP_SI_ZOMEASY", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 10, 22 ] }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 12 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_MIGO",
    "type": "mission_definition",
    "name": { "str": "Уничтожьте ми-го, пожирающего искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Группа смертоносных миго осушает локацию, где высокий резонанс пространства. Уничтожьте их всех за очень большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [ { "group": "GROUP_SI_MIGO", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked", "repeat": [ 2, 5 ] } ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 9 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_KILL_MIGO_ELITE",
    "type": "mission_definition",
    "name": { "str": "Убейте повелителя ми-го, пожирающего искажённое пространство!" },
    "goal": "MGOAL_KILL_MONSTER",
    "description": "Группа смертоносных миго осушает локацию, где высокий резонанс пространства. Уничтожьте их всех за очень большую награду в виде <color_light_blue>осколков искажённого пространства</color>.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_monster": [
          { "group": "GROUP_SI_MIGO", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked", "repeat": [ 0, 2 ] },
          { "group": "GROUP_SI_MIGO_ELITE", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked" }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 12 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_ASSASSIN1",
    "type": "mission_definition",
    "name": { "str": "Убейте вооруженного нарушителя!" },
    "goal": "MGOAL_ASSASSINATE",
    "description": "искажённое пространство приговорило к смерти одно-единственное человеческое существо. Скорее всего, у него будет оружие дальнего боя. Он будет одни. Его грехи вас не касаются. Все, что вам нужно знать, - это то, что его нужно убить.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": { "place_npcs": [ { "class": "bandit", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked." } ] }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 9 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_ASSASSIN2",
    "type": "mission_definition",
    "name": { "str": "Убейте незваного гостя!" },
    "goal": "MGOAL_ASSASSINATE",
    "description": "искажённое пространство приговорило к смерти одно-единственное человеческое существо. Скорее всего, у него будет оружие ближнего боя. Он будет одни. Его грехи вас не касаются. Все, что вам нужно знать, - это то, что его нужно убить",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": { "place_npcs": [ { "class": "thug", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked." } ] }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 6 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_ASSASSIN3",
    "type": "mission_definition",
    "name": { "str": "Убейте охраняемого нарушителя!" },
    "goal": "MGOAL_ASSASSINATE",
    "description": "искажённое пространство приговорило к смерти одно-единственное человеческое существо. Его могут сопровождать. Их грехи вас не касаются. Все, что вам нужно знать, - это то, что его нужно убить.",
    "difficulty": 0,
    "value": 0,
    "start": {
      "assign_mission_target": { "var": { "global_val": "OM_missionspot" } },
      "update_mapgen": {
        "place_npcs": [
          { "class": "thug", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked.", "repeat": [ 1, 2 ] },
          { "class": "bandit", "x": [ 1, 22 ], "y": [ 1, 22 ], "name": "Marked.", "repeat": [ 0, 1 ] },
          { "class": "bandit", "x": [ 1, 22 ], "y": [ 1, 22 ], "target": true, "name": "Marked." }
        ]
      }
    },
    "end": {
      "effect": [
        { "u_adjust_var": "missionswon", "adjustment": 1 },
        {
          "arithmetic": [
            { "global_val": "var", "var_name": "totalbonus" },
            "=",
            { "const": 12 },
            "+",
            { "global_val": "var", "var_name": "location_difficulty_bonus" }
          ]
        },
        {
          "u_message": "Дело сделано. Они все мертвы. Осколки искажённого пространства просачиваются из швов в реальности. Ваша награда сыплется на вас дождем.",
          "type": "mixed"
        },
        { "u_spawn_item": "warptoken", "count": { "global_val": "var", "var_name": "totalbonus", "default": 1 } }
      ]
    }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_ZED1",
    "type": "mission_definition",
    "name": { "str": "Убейте 10 зомби в этой экспедиции" },
    "description": "Зомби поглотили энергию искажённого пространства, которая должна быть снова освобождена. Убейте по крайней мере 10 зомбированных людей или существ, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "ZOMBIE",
    "monster_kill_goal": 10,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 1 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_ZED2",
    "type": "mission_definition",
    "name": { "str": "Убейте 50 зомби в этой экспедиции" },
    "description": "Зомби поглотили энергию искажённого пространства, которая должна быть снова освобождена. Убейте по крайней мере 50 зомбированных людей или существ, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "ZOMBIE",
    "monster_kill_goal": 50,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 3 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_ZED3",
    "type": "mission_definition",
    "name": { "str": "Убейте 100 зомби в этой экспедиции" },
    "description": "Зомби поглотили энергию искажённого пространства, которая должна быть снова освобождена. Убейте по крайней мере 100 зомбированных людей или существ, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "ZOMBIE",
    "monster_kill_goal": 100,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 5 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_MIGO",
    "type": "mission_definition",
    "name": { "str": "Убей Ми-Го в этой экспедиции" },
    "description": "Ми-го высосали энергию искажённого пространства, которая должна быть снова освобождена. Убейте по крайней мере одно существо миго, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "MIGO",
    "monster_kill_goal": 1,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 3 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_NETHER",
    "type": "mission_definition",
    "name": { "str": "Убейте 3 кошмаров в этой экспедиции" },
    "description": "Разрыв в другое измерение истощил нить пространство, из-за чего в мир были выпущены 'кошмары', которые поглотили энергию искажённого пространства. Убейте по крайней мере 3 кошмаров, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "NETHER",
    "monster_kill_goal": 3,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 4 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_BIRD",
    "type": "mission_definition",
    "name": { "str": "Убейте 5 незомбированных птиц в этой экспедиции" },
    "description": "Птицы здесь... сверкают? Похоже, даже местная дикая природа начала поглощать энергию искажённого пространства. Убейте по крайней мере 5 птиц любого вида, не являющихся зомби, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "BIRD",
    "monster_kill_goal": 5,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 1 } ] }
  },
  {
    "id": "MISSION_BONUS_SLAUGHTER_MAMMAL",
    "type": "mission_definition",
    "name": { "str": "Убейте 5 незомбированных зверей в этой экспедиции" },
    "description": "Здешние твари... сверкают? Похоже, даже местная дикая природа начала поглощать энергию искажённого пространства. Убейте по крайней мере 5 млекопитающих любого вида, не являющихся зомби, прежде чем вернуться в свое убежище за бонусными <color_light_blue>осколками искажённого пространства</color>.",
    "goal": "MGOAL_KILL_MONSTER_SPEC",
    "monster_species": "MAMMAL",
    "monster_kill_goal": 5,
    "difficulty": 0,
    "value": 0,
    "end": { "effect": [ { "u_adjust_var": "slaughterswon", "adjustment": 1 }, { "u_spawn_item": "warptoken", "count": 1 } ] }
  },
  {
    "type": "mapgen",
    "method": "json",
    "nested_mapgen_id": "mx_exitroom",
    "object": {
      "mapgensize": [ 11, 11 ],
      "rotation": [ 0, 3 ],
      "rows": [
        "           ",
        "  -     -  ",
        " ----D---- ",
        "--.......--",
        " -.......- ",
        " D...X...D ",
        " -.......- ",
        "--.......--",
        " ----D---- ",
        "  -     -  ",
        "           "
      ],
      "flags": [ "ERASE_ALL_BEFORE_PLACING_TERRAIN" ],
      "terrain": { "D": [ "t_door_c" ], "-": [ "t_wall_r" ], ".": [ "t_carpet_red" ], "X": [ "t_carpet_red" ], "x": [ "t_carpet_red" ] },
      "furniture": { "X": [ "f_returnportal" ], "D": [ "f_null" ], ".": [ "f_null" ], "x": [ "f_null" ] }
    }
  },
  {
    "type": "mapgen",
    "method": "json",
    "nested_mapgen_id": "mx_treasuregoal",
    "object": {
      "mapgensize": [ 5, 5 ],
      "rotation": [ 0, 3 ],
      "rows": [
        "  x  ",
        " xxx ",
        "xxoxx",
        " xxx ",
        "  x  "
      ],
      "terrain": { "x": [ "t_carpet_green" ], "o": [ "t_carpet_purple" ] },
      "items": { "o": [ { "item": "warp_mission_goal", "chance": 100 } ] },
      "flags": [ "ERASE_ALL_BEFORE_PLACING_TERRAIN" ]
    }
  },
  {
    "type": "mapgen",
    "method": "json",
    "update_mapgen_id": "mapgen_dummyplace",
    "//": "This is a stopgap. If revert_location is called without a mapgen update, the game crashes. So this is a blank map update that does nothing but still prevents the crash. To be removed if the bug gets patched.",
    "object": {
      "rows": [
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        ",
        "                        "
      ]
    }
  }
]
